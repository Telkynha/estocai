<div class="dashboard-container">
  <!-- Loading indicator -->
  @if (isLoading) {
    <div class="loading-container">
      <mat-icon class="loading-icon">hourglass_empty</mat-icon>
      <p>Carregando dados...</p>
    </div>
  }
  
  <!-- Summary Cards -->
  <div class="cards-grid">
    @for (card of cards; track card.title) {
      <mat-card>
        <mat-card-content>
          <div class="card-content">
            <div class="card-info">
              <div class="card-title">{{card.title}}</div>
              <div class="card-value">{{card.value}}</div>
              <div class="card-trend">{{card.trend}}</div>
            </div>
            <div class="card-icon">
              <mat-icon>{{card.icon}}</mat-icon>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    }
  </div>
  
  <!-- Advanced Analysis Cards -->
  <div class="new-cards-grid">
    @for (card of newCards; track card.title) {
      @switch (card.type) {
        @case ('comparison') {
          <mat-card class="comparison-card">
            <mat-card-header>
              <mat-icon>{{card.icon}}</mat-icon>
              <mat-card-title>{{card.title}}</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              @if (getComparisonCard(card); as comparisonCard) {
                <div class="comparison-item">
                  <div class="label">{{comparisonCard.current.label}}</div>
                  <div class="value">{{comparisonCard.current.value}}</div>
                  <mat-progress-bar mode="determinate" 
                                  [value]="comparisonCard.current.percentage"
                                  color="primary">
                  </mat-progress-bar>
                </div>
                <div class="comparison-item">
                  <div class="label">{{comparisonCard.previous.label}}</div>
                  <div class="value">{{comparisonCard.previous.value}}</div>
                  <mat-progress-bar mode="determinate" 
                                  [value]="comparisonCard.previous.percentage"
                                  color="accent">
                  </mat-progress-bar>
                </div>
              }
            </mat-card-content>
          </mat-card>
        }
        @case ('timeline') {
          <mat-card class="timeline-card">
            <mat-card-header>
              <mat-icon>{{card.icon}}</mat-icon>
              <mat-card-title>{{card.title}}</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              @if (getTimelineCard(card); as timelineCard) {
                @if (timelineCard.activities.length === 0) {
                  <div class="no-data">
                    <p>Nenhuma atividade recente encontrada.</p>
                  </div>
                } @else {
                  @for (activity of timelineCard.activities; track activity.time) {
                    <div class="activity" [class]="activity.status">
                      <div class="time">{{activity.time}}</div>
                      <div class="description">{{activity.description}}</div>
                    </div>
                  }
                }
              }
            </mat-card-content>
          </mat-card>
        }
        @case ('distribution') {
          <mat-card class="distribution-card">
            <mat-card-header>
              <mat-icon>{{card.icon}}</mat-icon>
              <mat-card-title>{{card.title}}</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              @if (getDistributionCard(card); as distributionCard) {
                <div class="total">
                  <div class="label">Total</div>
                  <div class="value">{{distributionCard.total}}</div>
                </div>
                <mat-divider></mat-divider>
                @if (distributionCard.categories.length === 0) {
                  <div class="no-data">
                    <p>Nenhuma categoria encontrada.</p>
                  </div>
                } @else {
                  @for (category of distributionCard.categories; track category.name) {
                    <div class="category">
                      <div class="color-indicator" [style.background-color]="category.color"></div>
                      <div class="name">{{category.name}}</div>
                      <div class="percentage">{{category.percentage}}%</div>
                    </div>
                  }
                }
              }
            </mat-card-content>
          </mat-card>
        }
      }
    }
  </div>
</div>
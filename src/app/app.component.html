<mat-sidenav-container>
  <mat-sidenav #sidenav mode="side" [class.expanded]="isExpanded" opened>
    <mat-toolbar>
      <button mat-icon-button (click)="toggleSidebar()">
        <mat-icon class="custom-icon">menu</mat-icon>
      </button>
      @if (isExpanded) {
      <span>Estocai</span>
      }
    </mat-toolbar>

    @if (authState.isAuthenticated()) {
    <div class="sidebar-content">
      <mat-nav-list>
        <a mat-list-item routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
          <mat-icon>home</mat-icon>
          @if (isExpanded) { <span>Dashboard</span> }
        </a>
        <a mat-list-item routerLink="/estoque" routerLinkActive="active">
          <mat-icon>inventory_2</mat-icon>
          @if (isExpanded) { <span>Estoque</span> }
        </a>
        <a mat-list-item routerLink="/movimentacoes" routerLinkActive="active">
          <mat-icon>swap_horiz</mat-icon>
          @if (isExpanded) { <span>Movimentações</span> }
        </a>
      </mat-nav-list>

      <div class="user-section">
        <mat-divider></mat-divider>
        <mat-nav-list class="bottom-nav-list">
          <a mat-list-item (click)="openConfig()">
            <mat-icon>settings</mat-icon>
            @if (isExpanded) { <span>Configurações</span> }
          </a>
          <a mat-list-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            @if (isExpanded) { <span>Sair</span> }
          </a>
        </mat-nav-list>
      </div>
    </div>
    }

    <div class="theme-section">
      <mat-divider></mat-divider>
      <div class="theme-toggle">
        <button mat-icon-button (click)="toggleTheme()">
          <mat-icon>{{ isDarkTheme ? 'light_mode' : 'dark_mode' }}</mat-icon>
        </button>
      </div>
    </div>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content [class.loading]="authState.loading()">
    @if (authState.loading()) {
      <div class="loading-overlay">
        <mat-spinner></mat-spinner>
      </div>
    } @else {
      <router-outlet></router-outlet>
    }
  </mat-sidenav-content>
</mat-sidenav-container>